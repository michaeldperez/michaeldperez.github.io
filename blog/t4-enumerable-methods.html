<!DOCTYPE html>
<html>
<head>
  <title></title>
  <meta charset="UTF-8">
  <link rel="stylesheet" type="text/css" href="../stylesheets/default.css">
  <link type="text/css" rel="stylesheet" href="../stylesheets/blog-stylesheet.css" />
  <script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js">
  </script>
</head>
<body>
<div class = "overlay">
<div class="blog-post-background">
<main>
  <h1>Ruby's <span class = "rbcode">group_by</span> Method:</h1>
  <h2>A No Nonsense Guide</h2>
  <h4>14 January 2015</h4>

  <section>
    <h3>Grouping Elements in a Collection</h3>
    <p>
      Once you are comfortable with <a href="./t3-arrays-hashes.html">collections</a> in Ruby, the next step is to master the methods that allow you to manipulate the elements, thereby unleashing the true potential of container objects. If you are familiar with Ruby's <a href="http://ruby-doc.org/core-2.0/Enumerable.html"><span class = "rbcode">Enumerable</span></a> module, then you are well aware of it's powerful collection-manipulation capabilities. As a Rubyist, it's tremendously important that you be aware of these methods and familiar with their use. To dispatch you on your journey, I'll introduce the <span class = "rbcode">group_by</span> method, because it works well with both arrays and hashes and it's use is fairly straightforward. Simply put, the <span class = "rbcode">group_by</span> method <em>is useful in those instances when you have a collection object and want to group the elements by some criterion they share in common</em>.
    </p>
    <h4>Syntax</h4>
    <p>
    <pre class = "prettyprint lang-rb linenums">
    group_by { |obj| block } #=> a_hash
    group_by #=> enumerator</pre>
    The <span class = "rbcode">group_by</span> method accepts a block, runs each element through the block, and then groups elements in the collection according to the result of the block. Specifically, <span class = "rbcode">group_by</span> returns a hash whose keys are the unique block return values and whose values are arrays of all the elements for which the block evaluated to that key value. When no block is given, <span class = "rbcode">group_by</span> returns an enumerator (which we will not be discussing here).
    </p>
    <p>
    In layman's terms, the <span class = "rbcode">group_by</span> method iterates over each item in a collection and applies that item to a specified block. The block's return value for that element, if unique, becomes a key in a newly-created hash, and the original element becomes an item in an array, which itself is the value of the previously mentioned key in the hash. If the return value is not unique, the original element is pushed into the array whose key corresponds to the block's return value for that element.
    </p>
    <p>
    If the concept of <span class = "rbcode">group_by</span> remains confusing, a few examples illustrating it's use with arrays and hashes should clear things up.
    </p>
    <h4><span class = "rbcode">group_by</span> with Arrays</h4>
    <p>
    Let's say you have a two-dimensional array, which we'll call <span class = "rbcode">people</span>, containing a set of individuals as well as their sex. If we wanted to group the members of the array by their respective sex, we could do so using the <span class = "rbcode">group_by</span> method:
    <pre class = "prettyprint lang-rb linenums toobig">
    &gt;&gt; people = [["John Smith", "Male"], ["Mary Johnson", "Female"], ["Liz Clay", "Female"],["Michael Jones","Male"]]

    &gt;&gt; #=> [["John Smith", "Male"], ["Mary Johnson", "Female"], ["Liz Clay", "Female"],["Michael Jones","Male"]]

    &gt;&gt; people.group_by{ |person| person[1] }

    &gt;&gt;<span class = "tootoobig"> #=> {"Male"=>[["John Smith", "Male"], ["Michael Jones", "Male"]], "Female"=>[["Mary Johnson", "Female"], ["Liz Clay", "Female"]]}</span></pre>
    As expected, the <span class = "rbcode">group_by</span> method iterates over each item in the <span class = "rbcode">people</span> array and groups individuals by their sex. This is indicated by the block <span class = "rbcode">{ |person| person[1] }</span>, where <span class = "rbcode">person</span> is each array object in the <span class = "rbcode">people</span> array and <span class = "rbcode">[1]</span> refers to the second item in the <span class = "rbcode">person</span> array; here, the individual's sex. The resulting hash has two keys, <span class = "rbcode">"Male"</span> and <span class = "rbcode">"Female"</span>, with the respective array values of <span class = "rbcode">[["John Smith", "Male"], ["Michael Jones", "Male"]]</span> and <span class = "rbcode">[["Mary Johnson", "Female"], ["Liz Clay", "Female"]]</span>.
    </p>
    <p>
    The <span class = "rbcode">group_by</span> method also works well with other Ruby objects, for example: numbers. Let's say you have an array consisting of the set of integers between 1 and 10, inclusive. If you wanted to group the integers by the remainder after dividing into 30, you could do so (I can't think of a reason why you would need to, but in any case):
    <pre class = "prettyprint lang-rb linenums">
    &gt;&gt; one_to_ten = *(1..10)
    &gt;&gt; #=> [1,2,3,4,5,6,7,8,9,10]
    &gt;&gt; one_to_ten.group_by{ |num| 30 % num }
    &gt;&gt; #=> {0=>[1, 2, 3, 5, 6, 10], 6=>[8], 2=>[4, 7], 3=>[9]} </pre>
    The result is a hash consisting of the integers from the array <span class = "rbcode">one_to_ten</span> grouped according to the remainder of dividing 30 by that number. (If the expression <span class = "rbcode">*(1..10)</span>) is unfamiliar to you, see the explanation of "array coercion" <a href = "http://www.jacopretorius.net/2012/01/splat-operator-in-ruby.html">here</a>).
    </p>
    <h4><span class = "rbcode">group_by</span> with Hashes</h4>
    <p>
    Grouping hash elements is similar to grouping elements in an array. The only difference is that the block accepts a key/value pair. However, because a hash's keys are unique, it's pretty much only useful to group a hash's elements by their values. (Try it for yourself. If you use <span class = "rbcode">group_by</span> and group according to key, the result will be a fairly meaningless hash consisting of each original key, followed by a array of the same key and it's paired value).
    </p>
    <p>
    With that proviso out of the way, let's move forward with an example. Assume you have a hash consisting of partners with whom you have pair-programmed, followed by the number of times you have paired with them. We'll call this hash <span class = "rbcode">pairings</span>. If we want to group our partners by the number of times we've paired with them, we could use the <span class = "rbcode">group_by</span> method:
    <pre class = "prettyprint lang-rb linenums">
    &gt;&gt; pairings = {
            "Malcolm Reynolds" => 2,
            "Zoe Washburne"    => 1,
            "Hoban Washburne"  => 3,
            "Inara Serra"      => 1,
            "Jayne Cobb"       => 2,
            "Kaylee Frye"      => 3,
            "Simon Tam"        => 2,
            "River Tam"        => 1,
            "Derrial Book"     => 2
    }

    &gt;&gt; #=> {"Malcolm Reynolds" =>2, "Zoe Washburne"=>1,"Hoban Washburne"=>3, "Inara Serra"=>1,
       #=> "Jayne Cobb"=>2, "Kaylee Frye"=>3, "Simon Tam"=>2, "River Tam"=>1, "Derrial Book"=>2}

    &gt;&gt; pairings.group_by{ |person, pairings| pairings }

    &gt;&gt; #=> {1=>[["River Tam", 1], ["Inara Serra", 1], ["Zoe Washburne", 1]], 2=>[["Jayne Cobb", 2],
       #=> ["Simon Tam", 2], ["Malcolm Reynolds", 2], ["Derrial Book", 2]], 3=>[["Hoban Washburne", 3],
       #=> ["Kaylee Frye", 3]]}
    </pre>
    The output is the <span class = "rbcode">pairings</span> key/value pairs placed into a new hash grouping partners by the number of times you've paired with them.
    </p>
    <h4>Conclusion</h4>
    <p>
    To sum up what we've learned, the <span class = "rbcode">group_by</span> method is an enumerable method that iterates over a container object (i.e. an array or a hash), and groups the collection's elements according to the result of running each element through a supplied block. We've illustrated how the method works in practice using examples of both arrays and hashes, as well as element input of strings, integers, and arrays. And while no examples made use of them, Ruby symbols would work equally well as input. Now, if you ever have a container object and need to group the elements according to some common feature, you'll know how to use Ruby's <span class = "rbcode">group_by</span> method.
    </p>
    <p>
    "But wait!", you say. What about Booleans?! <span class = "rbcode">group_by</span> is equally capable of handling boolean elements. But what if you want to group elements by whether or not they possess some characteristic? In such cases, you'll likely use Ruby's <span class = "rbcode"><a href="http://ruby-doc.org/core-2.0/Enumerable.html#method-i-partition">partition</a></span> method. Briefly, the <span class = "rbcode">partition</span> method iterates over a collection and returns two arrays (not a hash, like <span class = "rbcode">group_by</span>!): one array containing those elements for which the block returns <span class = "rbcode">true</span>, and a second array for those elements that evaluate to <span class = "rbcode">false</span>.
    </p>
    <p>
    As an example, let's return to our <span class = "rbcode">one_to_ten</span> array. If we wanted to group the items by whether they are even or not, you could use the <span class = "rbcode">partition</span> method. You could even create two new variables, consisting of those items between 1 and 10 that are even, called <span class = "rbcode">evens</span>, and those that are not, labeled <span class = "rbcode">odds</span>:
    <pre class = "prettyprint lang-rb linenums">
    &gt;&gt; one_to_ten.partition{ |num| num.even? }
    &gt;&gt; #=> [[2,4,6,8,10],[1,3,5,7,9]]
    &gt;&gt; evens, odds = one_to_ten.partition{ |num| num.even? }
    &gt;&gt; #=> [[2,4,6,8,10],[1,3,5,7,9]]
    &gt;&gt; evens
    &gt;&gt; #=> [2,4,6,8,10]
    &gt;&gt; odds
    &gt;&gt; #=> [1,3,5,7,9]</pre>
    You could then use these new variables in further operations.
    </p>
    <p>
    And there you have it. Ruby has a quite versatile set of enumerable methods that allow you to group elements in a collection. Unless the block is intended to return a boolean value, use Ruby's <span class = "rbcode">group_by</span> method. Otherwise, use it's <span class = "rbcode">partition</span> method.
    </p>
  </section>
  <section>
  <p>
    <div id="nav-footer">
      <p class="post-nav"><a href="./c3-thinking-style.html">Previous</a> |</p>
      <p class="post-nav"><a href="./index.html">Home</a> |</p>
      <p class="post-nav"><a href="#">Next</a></p>
    </div>
  </p>
  </section>
</main>
</div>
</div>
</body>
</html>